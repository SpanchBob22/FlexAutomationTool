<Window x:Class="FlexAutomator.Views.ScenarioEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:viewModels="clr-namespace:FlexAutomator.ViewModels"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=viewModels:ScenarioEditorViewModel}"
        Title="Редактор сценарію" 
        Height="800" Width="950"
        Background="{StaticResource AppBackgroundBrush}"
        TextElement.Foreground="{StaticResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        FontFamily="{DynamicResource MaterialDesignFont}"
        WindowStartupLocation="CenterScreen"
        WindowStyle="SingleBorderWindow"
        PreviewKeyDown="Window_PreviewKeyDown">

    <Window.Resources>

        <DataTemplate DataType="{x:Type viewModels:TimeTriggerViewModel}">
            <StackPanel Margin="16,0,16,16">
                <materialDesign:TimePicker
                    SelectedTime="{Binding TriggerTime, Mode=TwoWay}"
                    Is24Hours="True"
                    materialDesign:HintAssist.Hint="Час запуску"
                    Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                    Margin="0,0,0,12"/>

                <TextBlock Text="Дні тижня:" FontSize="12" Opacity="0.6" Margin="0,0,0,8"/>
                <WrapPanel>
                    <CheckBox Content="Пн" IsChecked="{Binding Monday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Вт" IsChecked="{Binding Tuesday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Ср" IsChecked="{Binding Wednesday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Чт" IsChecked="{Binding Thursday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Пт" IsChecked="{Binding Friday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Сб" IsChecked="{Binding Saturday}" Margin="0,0,12,0"/>
                    <CheckBox Content="Нд" IsChecked="{Binding Sunday}"/>
                </WrapPanel>
            </StackPanel>
        </DataTemplate>

  
        <DataTemplate DataType="{x:Type viewModels:CyclicTriggerViewModel}">
            <StackPanel Margin="16,0,16,16">
                <TextBox Text="{Binding IntervalVal}" 
                         materialDesign:HintAssist.Hint="Інтервал (число)" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         PreviewTextInput="NumberValidationTextBox"
                         Margin="0,0,0,12"/>
                <ComboBox ItemsSource="{Binding Units}"
                          SelectedItem="{Binding TimeUnit}"
                          materialDesign:HintAssist.Hint="Одиниця часу"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"/>
            </StackPanel>
        </DataTemplate>

    
        <DataTemplate DataType="{x:Type viewModels:HotkeyTriggerViewModel}">
            <StackPanel Margin="16,0,16,16">
                <Grid Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0" 
                             Text="{Binding HotKeyVal}" 
                             IsReadOnly="True"
                             materialDesign:HintAssist.Hint="Натисніть 'Записати'..." 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             VerticalAlignment="Center"/>

                    <Button Grid.Column="1" 
                            Command="{Binding StartRecordingCommand}" 
                            Margin="12,0,0,0"
                            ToolTip="Записати комбінацію">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignOutlinedButton}">
                                <Setter Property="BorderBrush" Value="#EF5350"/>
                                <Setter Property="Foreground" Value="#EF5350"/>
                                <Setter Property="Content">
                                    <Setter.Value>
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Record" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Записати"/>
                                        </StackPanel>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsRecording}" Value="True">
                                        <Setter Property="BorderBrush" Value="#66BB6A"/>
                                        <Setter Property="Foreground" Value="#66BB6A"/>
                                        <Setter Property="Content" Value="Очікування..."/>
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>

                <TextBlock Text="Модифікатори:" FontSize="12" Margin="0,0,0,6" Opacity="0.6"/>
                <WrapPanel>
                    <CheckBox Content="Ctrl" IsChecked="{Binding IsCtrl}" IsEnabled="False" Margin="0,0,12,0"/>
                    <CheckBox Content="Shift" IsChecked="{Binding IsShift}" IsEnabled="False" Margin="0,0,12,0"/>
                    <CheckBox Content="Alt" IsChecked="{Binding IsAlt}" IsEnabled="False"/>
                </WrapPanel>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:FileChangeTriggerViewModel}">
            <StackPanel Margin="16,0,16,16">
                <Grid Margin="0,0,0,8">
                    <TextBlock Text="Шлях та подія" VerticalAlignment="Center" FontWeight="Medium" Opacity="0.6"/>
                    <Button HorizontalAlignment="Right" 
                            Command="{Binding CopyIdCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Height="24" Padding="8,0"
                            BorderBrush="{StaticResource SubtleBorderBrush}"
                            Foreground="{StaticResource MaterialDesignBody}"
                            ToolTip="Копіювати ID">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentCopy" Width="12" Height="12" Margin="0,0,6,0"/>
                            <TextBlock Text="ID" FontSize="10"/>
                        </StackPanel>
                    </Button>
                </Grid>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding WatchedPath}" 
                             materialDesign:HintAssist.Hint="Шлях до файлу або папки" 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             VerticalAlignment="Center"/>
                    <Button Grid.Column="1" Command="{Binding PickFileCommand}" ToolTip="Обрати файл" Style="{StaticResource MaterialDesignIconForegroundButton}" Margin="4,0">
                        <materialDesign:PackIcon Kind="FileOutline" />
                    </Button>
                    <Button Grid.Column="2" Command="{Binding PickFolderCommand}" ToolTip="Обрати папку" Style="{StaticResource MaterialDesignIconForegroundButton}" Margin="4,0,0,0">
                        <materialDesign:PackIcon Kind="FolderOutline" />
                    </Button>
                </Grid>
                <ComboBox ItemsSource="{Binding Events}"
                          SelectedItem="{Binding ChangeEvent}"
                          materialDesign:HintAssist.Hint="Тип події"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          Margin="0,12,0,0"/>
                <CheckBox Content="Рекурсивно (включаючи підпапки)" IsChecked="{Binding IsRecursive}" Margin="0,12,0,0"/>
            </StackPanel>
        </DataTemplate>

        <DataTemplate DataType="{x:Type viewModels:TelegramCommandTriggerViewModel}">
            <StackPanel Margin="16,0,16,16">
                <TextBox Text="{Binding BotCommand}" 
                         materialDesign:HintAssist.Hint="Команда (наприклад: /start)" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Margin="0,0,0,12"/>

                <TextBox Text="{Binding CommandDescription}" 
                         materialDesign:HintAssist.Hint="Опис (для меню Telegram)" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:MouseClickActionViewModel}">
            <StackPanel Margin="16,0,16,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding PosX}" 
                             materialDesign:HintAssist.Hint="Координата X" 
                             PreviewTextInput="NumberValidationTextBox"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}" 
                             Margin="0,0,6,0"/>
                    <TextBox Grid.Column="1" Text="{Binding PosY}" 
                             materialDesign:HintAssist.Hint="Координата Y" 
                             PreviewTextInput="NumberValidationTextBox"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}" 
                             Margin="6,0,0,0"/>
                    <Button Grid.Column="2" Command="{Binding PickCoordinatesCommand}" 
                            Style="{StaticResource MaterialDesignOutlinedButton}" 
                            ToolTip="Вибрати координати" 
                            Margin="12,0,0,0" Padding="12,0">
                        <materialDesign:PackIcon Kind="CrosshairsGps" />
                    </Button>
                </Grid>
                <ComboBox ItemsSource="{Binding Buttons}" SelectedItem="{Binding MouseBtn}" materialDesign:HintAssist.Hint="Кнопка миші" Style="{StaticResource MaterialDesignOutlinedComboBox}" Margin="0,12,0,0"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:KeyboardInputActionViewModel}">
            <StackPanel Margin="16,0,16,16">
                <TextBox Text="{Binding InputText, UpdateSourceTrigger=PropertyChanged}" 
                         materialDesign:HintAssist.Hint="Текст (підтримується {GUID})" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         AcceptsReturn="True" TextWrapping="Wrap" MinHeight="80"
                         Margin="0,0,0,12"/>
                <ComboBox ItemsSource="{Binding Methods}" SelectedItem="{Binding TypingMethod}" materialDesign:HintAssist.Hint="Метод вводу" Style="{StaticResource MaterialDesignOutlinedComboBox}"/>

                <ComboBox ItemsSource="{Binding Formats}" SelectedItem="{Binding ListFormat}" 
                          materialDesign:HintAssist.Hint="Формат списку" 
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          Margin="0,12,0,0"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:ProcessActionViewModel}">
            <StackPanel Margin="16,0,16,16">
                <ComboBox ItemsSource="{Binding Actions}" SelectedItem="{Binding ProcessMode}" materialDesign:HintAssist.Hint="Дія" Style="{StaticResource MaterialDesignOutlinedComboBox}" Margin="0,0,0,12"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Grid.Column="0" Text="{Binding ExecutablePath}" materialDesign:HintAssist.Hint="Шлях до програми" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                    <Button Grid.Column="1" Command="{Binding BrowseFileCommand}" ToolTip="Обрати файл" Style="{StaticResource MaterialDesignIconForegroundButton}" Margin="4,0,0,0">
                        <materialDesign:PackIcon Kind="FileOutline" />
                    </Button>
                </Grid>
                <TextBox Text="{Binding TargetProcessName}" materialDesign:HintAssist.Hint="Назва процесу (для закриття)" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,12,0,0"/>
            </StackPanel>
        </DataTemplate>

 
        <DataTemplate DataType="{x:Type viewModels:DelayActionViewModel}">
            <StackPanel Margin="16,0,16,16">
                <TextBox Text="{Binding DelayDurationMs}" 
                         materialDesign:HintAssist.Hint="Затримка (мс)" 
                         materialDesign:HintAssist.HelperText="1000 мс = 1 секунда"
                         PreviewTextInput="NumberValidationTextBox"
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:YouTubeCheckViewModel}">
            <StackPanel Margin="16,0,16,16">
                <Button HorizontalAlignment="Right" 
                            Command="{Binding CopyIdCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Height="24" Padding="8,0" Margin="0,0,0,8"
                            BorderBrush="{StaticResource SubtleBorderBrush}"
                            Foreground="{StaticResource MaterialDesignBody}"
                            ToolTip="Копіювати ID блоку">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ContentCopy" Width="12" Height="12" Margin="0,0,6,0"/>
                        <TextBlock Text="ID" FontSize="10"/>
                    </StackPanel>
                </Button>
                <TextBox Text="{Binding YtChannelId}" materialDesign:HintAssist.Hint="ID каналу YouTube" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,12"/>
                <TextBox Text="{Binding YtApiKey}" materialDesign:HintAssist.Hint="API ключ YouTube" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:TMDbCheckViewModel}">
            <StackPanel Margin="16,0,16,16">
                <Button HorizontalAlignment="Right" 
                            Command="{Binding CopyIdCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Height="24" Padding="8,0" Margin="0,0,0,8"
                            BorderBrush="{StaticResource SubtleBorderBrush}"
                            Foreground="{StaticResource MaterialDesignBody}"
                            ToolTip="Копіювати ID блоку">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ContentCopy" Width="12" Height="12" Margin="0,0,6,0"/>
                        <TextBlock Text="ID" FontSize="10"/>
                    </StackPanel>
                </Button>
                <ComboBox ItemsSource="{Binding Genres}" SelectedItem="{Binding MovieGenre}" materialDesign:HintAssist.Hint="Жанр" Style="{StaticResource MaterialDesignOutlinedComboBox}" Margin="0,0,0,12"/>
                <ComboBox ItemsSource="{Binding Periods}" SelectedItem="{Binding SearchPeriod}" materialDesign:HintAssist.Hint="Період пошуку" Style="{StaticResource MaterialDesignOutlinedComboBox}" Margin="0,0,0,12"/>
                <TextBox Text="{Binding TmdbKey}" materialDesign:HintAssist.Hint="API ключ TMDb" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,12"/>
                <TextBox Text="{Binding SearchRegion}" materialDesign:HintAssist.Hint="Регіон" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
            </StackPanel>
        </DataTemplate>


        <DataTemplate DataType="{x:Type viewModels:TelegramSendViewModel}">
            <StackPanel Margin="16,0,16,16">
                <TextBox Text="{Binding TextMessage, UpdateSourceTrigger=PropertyChanged}" 
                         materialDesign:HintAssist.Hint="Повідомлення (підтримується {GUID})" 
                         Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         AcceptsReturn="True" TextWrapping="Wrap" MinHeight="80"/>

                <ComboBox ItemsSource="{Binding Formats}" SelectedItem="{Binding ListFormat}" 
                          materialDesign:HintAssist.Hint="Формат списку" 
                          Style="{StaticResource MaterialDesignOutlinedComboBox}"
                          Margin="0,12,0,0"/>
            </StackPanel>
        </DataTemplate>

    </Window.Resources>


    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>


        <TextBox Grid.Row="0" Text="{Binding ScenarioName, UpdateSourceTrigger=PropertyChanged}"
                 materialDesign:HintAssist.Hint="Назва сценарію" 
                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                 FontSize="20" Margin="0,0,0,24"/>


        <materialDesign:Card Grid.Row="1" Padding="16" Margin="0,0,0,16"
                           UniformCornerRadius="8"
                           Background="{StaticResource MaterialDesignCardBackground}"
                           BorderBrush="{StaticResource SubtleBorderBrush}"
                           BorderThickness="1">
            <materialDesign:Card.Effect>
                <DropShadowEffect BlurRadius="10" Direction="270" ShadowDepth="3" Opacity="0.3" Color="Black"/>
            </materialDesign:Card.Effect>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <ComboBox Grid.Column="0" ItemsSource="{Binding AvailableBlockTypes}" SelectedItem="{Binding SelectedBlockType}"
                          materialDesign:HintAssist.Hint="Виберіть блок для додавання"
                          Style="{StaticResource MaterialDesignOutlinedComboBox}" Margin="0,0,16,0"/>
                <Button Grid.Column="1" 
                        Content="Додати" 
                        Command="{Binding AddBlockCommand}" 
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        BorderBrush="{StaticResource SubtleBorderBrush}"
                        Foreground="{StaticResource MaterialDesignBody}"/>
            </Grid>
        </materialDesign:Card>

   
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled">
            <ItemsControl ItemsSource="{Binding Blocks}" Focusable="False">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <materialDesign:Card Margin="0,0,0,16" Padding="0"
                                           UniformCornerRadius="8"
                                           Background="{StaticResource MaterialDesignCardBackground}"
                                           BorderBrush="{StaticResource SubtleBorderBrush}"
                                           BorderThickness="1">
                            <materialDesign:Card.Effect>
                                <DropShadowEffect BlurRadius="8" Direction="270" ShadowDepth="2" Opacity="0.3" Color="Black"/>
                            </materialDesign:Card.Effect>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                          
                                    <ColumnDefinition Width="*" />
                        
                                    <ColumnDefinition Width="Auto" />
                     
                                </Grid.ColumnDefinitions>

                         
                                <Border Grid.Column="0" Width="6" CornerRadius="4,0,0,4">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="{StaticResource SubtleBorderBrush}"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsTrigger}" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource SecondaryHueMidBrush}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                </Border>

                   
                                <StackPanel Grid.Column="1" Margin="0,12">
                                    <StackPanel Orientation="Horizontal" Margin="16,0,0,8">
                                        <TextBlock Text="{Binding DisplayName}" FontSize="16" FontWeight="SemiBold"/>

                                
                                        <Border Background="{StaticResource SecondaryHueMidBrush}" 
                                                CornerRadius="4" Margin="12,0,0,0" Padding="6,1"
                                                VerticalAlignment="Center"
                                                Visibility="{Binding IsTrigger, Converter={StaticResource BooleanToVisibilityConverter}}">
                                            <TextBlock Text="Тригер" FontSize="10" Foreground="White" FontWeight="Bold"/>
                                        </Border>
                                    </StackPanel>

                                    <ContentControl Content="{Binding}" Focusable="False" />
                                </StackPanel>

                              
                                <StackPanel Grid.Column="2" VerticalAlignment="Top" Margin="8">
                                    <Button Command="{Binding DeleteCommand}" 
                                            Style="{StaticResource MaterialDesignIconForegroundButton}" 
                                            ToolTip="Видалити"
                                            Foreground="{StaticResource MaterialDesignBody}"
                                            Opacity="0.5">
                                        <materialDesign:PackIcon Kind="Close" />
                                    </Button>

                                    <Button Command="{Binding MoveUpCommand}" ToolTip="Вгору">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignIconForegroundButton}">
                                                <Setter Property="Foreground" Value="{StaticResource MaterialDesignBody}"/>
                                                <Setter Property="Opacity" Value="0.5"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding CanMoveUp}" Value="False">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <materialDesign:PackIcon Kind="ArrowUp" />
                                    </Button>

                                    <Button Command="{Binding MoveDownCommand}" ToolTip="Вниз">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignIconForegroundButton}">
                                                <Setter Property="Foreground" Value="{StaticResource MaterialDesignBody}"/>
                                                <Setter Property="Opacity" Value="0.5"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding CanMoveDown}" Value="False">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <materialDesign:PackIcon Kind="ArrowDown" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </materialDesign:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>


        <Border Grid.Row="3" 
                BorderBrush="{StaticResource SubtleBorderBrush}" 
                BorderThickness="0,1,0,0" 
                Padding="0,20,0,0"
                Margin="0,0,0,0"
                Background="Transparent">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Скасувати" 
                        Style="{StaticResource MaterialDesignOutlinedButton}" 
                        Foreground="{StaticResource MaterialDesignBody}"
                        BorderBrush="{StaticResource SubtleBorderBrush}"
                        Click="Cancel_Click" 
                        Margin="0,0,16,0"/>

                <Button Content="Зберегти" 
                        Style="{StaticResource MaterialDesignOutlinedButton}" 
                        Foreground="{StaticResource MaterialDesignBody}"
                        BorderBrush="{StaticResource SubtleBorderBrush}"
                        Command="{Binding SaveCommand}" 
                        Click="Save_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>